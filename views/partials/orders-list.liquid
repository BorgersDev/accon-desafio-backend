{% for order in orders %}
          {%- assign itemsCount = order.itemsCount | default: order.items.size | default: 0 -%}
          {%- assign totalOD = order.total.orderAmount.value -%}
          {%- assign totalFallback = order.total -%}
          {%- assign customerName = order.customer.name | default: order.user.name | default: order.customer | default: "Cliente" -%}
          {%- assign dateSource = order.createdAt | default: order.date -%}

          <tr class="hover:bg-neutral-50">
            <!-- Date + time -->
            <td class="px-5 py-4">
              <div class="leading-tight">
                <div>{{ dateSource | date: "%d/%m/%Y" }}</div>
                <div class="text-xs text-neutral-500">{{ dateSource | date: "%H:%M:%S" }}</div>
              </div>
            </td>

            <!-- Customer -->
            <td class="px-5 py-4">
              {{ customerName }}
            </td>

            <!-- Items (name × quantity) -->
            <td class="px-5 py-4 align-top">
              {% if order.items and order.items.size > 0 %}
              <ul class="space-y-1">
                {% for item in order.items %}
                <li class="truncate">
                  <span class="font-medium">{{ item.name }}</span>
                  <span class="text-neutral-500">× {{ item.quantity }}</span>
                </li>
                {% endfor %}
              </ul>
              {% else %}
              {{ itemsCount }}
              {% endif %}
            </td>

            <!-- Total -->
            <td class="px-5 py-4 font-medium">
              {{ order.total }}
            </td>

            <!-- Actions -->
            <td class="px-5 py-4">
              <div class="flex items-center justify-end gap-3">
                <!-- Visualize -->
                <button type="button"
                  class="inline-flex h-9 w-9 items-center justify-center rounded-full border border-neutral-200 text-neutral-600 hover:bg-neutral-100"
                  title="Visualize" aria-label="Visualize order"
                  onclick="visualizeOrder('{{ order.id }}')"
                  >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M2.036 12.322a1.012 1.012 0 010-.644C3.423 7.51 7.36 5 12 5c4.64 0 8.577 2.51 9.964 6.678.07.207.07.437 0 .644C20.577 16.49 16.64 19 12 19c-4.64 0-8.577-2.51-9.964-6.678z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                </button>

                <!-- Remove -->
                  <button type="button"
                    onclick="removeOrder('{{ order.id | default: order._id }}')"
                    class="inline-flex h-9 w-9 items-center justify-center rounded-full border border-red-200 text-red-600 hover:bg-red-50"
                    title="Excluir" aria-label="Excluir pedido">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                      stroke="currentColor" stroke-width="1.5">
                      <path stroke-linecap="round" stroke-linejoin="round"
                        d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21a48.108 48.108 0 00-3.478-.397M4.772 5.79c1.15-.135 2.3-.24 3.45-.316m0 0l.324-1.62A1.125 1.125 0 019.65 3h4.7c.53 0 .992.37 1.104.89l.325 1.585m-7.532-.005a48.667 48.667 0 017.532.005M6.75 9h10.5m-1.5 12H8.25A2.25 2.25 0 016 18.75V9.75h12v9A2.25 2.25 0 0116.5 21z" />
                    </svg>
                  </button>
              </div>
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="5" class="px-5 py-10 text-center text-neutral-500">
              Nenhum pedido encontrado.
            </td>
          </tr>
          {% endfor %}